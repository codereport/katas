âŸ¨Deltas, GroupâŸ© â‡ â€¢Import "../../bqn-code/lib/fun.bqn"

# Helper Functions
HasAce   â† âˆ¨Â´12=13|âŠ¢
HasKing  â† âˆ¨Â´11=13|âŠ¢
NOfAKind â† {âŠ‘ğ•¨âˆŠâ‰ Â¨âŠ”âˆ§13|ğ•©}

# Predicate Poker Functions
IsFlush         â† âˆ§Â´Â·âŠ‘âŠ¸=13âŠ¸|
IsStraight      â† {âˆ§Â´1=Deltasâˆ§13|ğ•©} # misses A-5
IsStraightFlush â† IsStraight âˆ§ IsFlush
IsRoyalFlush    â† IsStraightFlush âˆ§ HasAce âˆ§ HasKing
IsFullHouse     â† {2â€¿3â‰¡âˆ§â‰ Â¨Groupâˆ§13|ğ•©}
IsOnePair       â† 2âŠ¸NOfAKind
IsTwoPair       â† {1â€¿2â€¿2â‰¡âˆ§â‰ Â¨Groupâˆ§13|ğ•©}
IsThreeOfAKind  â† 3âŠ¸NOfAKind
IsFourOfAKind   â† 4âŠ¸NOfAKind

# Poker Hand
PokerHand â† {
    IsRoyalFlush    ğ•© ? "Royal Flush"    ;
    IsStraightFlush ğ•© ? "Straight Flush" ;
    IsFourOfAKind   ğ•© ? "4 of a Kind"    ;
    IsFullHouse     ğ•© ? "Full House"     ;
    IsFlush         ğ•© ? "Flush"          ;
    IsStraight      ğ•© ? "Straight"       ;
    IsThreeOfAKind  ğ•© ? "3 of a Kind"    ;
    IsTwoPair       ğ•© ? "Two Pair"       ;
    IsOnePair       ğ•© ? "Pair"           ;
                        "High Card"
}

# Printing
GenerateHand â† â€¢rand.RangeÂ¨â¥ŠâŸœ52
FmtVal       â† {8>ğ•©?â€¢Fmt 2+ğ•©;âŠ‘"TJQKA"âŠËœ8|ğ•©}
FmtHand      â† âˆ§13âŠ¸(("â™ â™¥â™¦â™£"âŠËœâŒŠâˆ˜Ã·Ëœ)âˆ¾Â¨(FmtValÂ¨|))

# Tests
hands â† GenerateHandÂ¨ 10â¥Š5
â€¢ShowÂ¨ (PokerHandâ‹ˆFmtHand)Â¨ hands
